<Page x:Class="WorkOrderManagementSystem.Views.Pages.CustomersPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Customers" Height="464" Width="1019">
    <Grid Background="#F5F5F5" Margin="20">
        <DockPanel>
            <!-- Header -->
            <StackPanel DockPanel.Dock="Top" Margin="0,0,0,20">
                <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="0,0,0,15">
                    <StackPanel VerticalAlignment="Top">
                        <TextBlock Text="Customer Management" FontSize="28" FontWeight="Bold" Margin="0,0,0,5"/>
                        <TextBlock Text="Manage customer information and repair history" FontSize="14" Foreground="#666"/>
                    </StackPanel>
                    <Button Name="AddCustomerBtn" 
                            Content="+ Add Customer" 
                            Background="#222" 
                            Foreground="White" 
                            Padding="20,12"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Click="AddCustomerBtn_Click"
                            VerticalAlignment="Top"/>
                </StackPanel>

                <!-- Search Box -->
                <Border Background="White" CornerRadius="5" Padding="15">
                    <TextBox Name="SearchBox" 
                             Height="40" 
                             Padding="15" 
                             FontSize="13"
                             Foreground="#666"
                             TextChanged="SearchBox_TextChanged"/>
                </Border>
            </StackPanel>

            <!-- Main Content Area -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="0.55*"/>
                    <ColumnDefinition Width="15"/>
                    <ColumnDefinition Width="0.45*"/>
                </Grid.ColumnDefinitions>

                <!-- Left: Customer List -->
                <Border Background="White" CornerRadius="5" Padding="0">
                    <DockPanel>
                        <TextBlock DockPanel.Dock="Top" Text="Customer List" FontSize="16" FontWeight="Bold" Padding="20,15,20,10"/>
                        <DataGrid Name="CustomersGrid" 
                                  IsReadOnly="True" 
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  BorderThickness="0"
                                  MouseDoubleClick="CustomersGrid_MouseDoubleClick"
                                  SelectionChanged="CustomersGrid_SelectionChanged"
                                  Padding="20,0,20,20">
                            <DataGrid.ColumnHeaderStyle>
                                <Style TargetType="DataGridColumnHeader">
                                    <Setter Property="Background" Value="Transparent"/>
                                    <Setter Property="BorderThickness" Value="0,0,0,1"/>
                                    <Setter Property="BorderBrush" Value="#E0E0E0"/>
                                    <Setter Property="Padding" Value="10,10"/>
                                    <Setter Property="FontWeight" Value="SemiBold"/>
                                    <Setter Property="Foreground" Value="#333"/>
                                </Style>
                            </DataGrid.ColumnHeaderStyle>
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Name" Binding="{Binding FullName}" Width="*" />
                                <DataGridTextColumn Header="Contact" Binding="{Binding Phone}" Width="120" />
                                <DataGridTextColumn Header="Total Jobs" Binding="{Binding TotalJobs}" Width="80" />
                                <DataGridTextColumn Header="Last Visit" Binding="{Binding LastVisit}" Width="100" />
                                <DataGridTemplateColumn Header="Actions" Width="100">
                                    <DataGridTemplateColumn.CellTemplate>
                                        <DataTemplate>
                                            <Button Content="Edit" 
                                                    Background="Transparent" 
                                                    Foreground="#2196F3"
                                                    Click="ViewHistoryButton_Click"
                                                    Tag="{Binding Id}"
                                                    Cursor="Hand"/>
                                        </DataTemplate>
                                    </DataGridTemplateColumn.CellTemplate>
                                </DataGridTemplateColumn>
                            </DataGrid.Columns>
                        </DataGrid>
                    </DockPanel>
                </Border>

                <!-- Splitter -->
                <GridSplitter Grid.Column="1" Width="15" Background="Transparent" HorizontalAlignment="Stretch"/>

                <!-- Right: Customer History -->
                <Border Grid.Column="2" Background="White" CornerRadius="5" Padding="20">
                    <ScrollViewer>
                        <StackPanel Name="HistoryPanel">
                            <TextBlock Name="HistoryTitle" Text="Select a customer to view history" FontSize="16" FontWeight="Bold" Margin="0,0,0,20"/>
                            
                            <!-- Contact Information Section -->
                            <StackPanel Name="ContactInfoPanel" Visibility="Collapsed" Margin="0,0,0,25">
                                <TextBlock Text="Contact Information" FontSize="13" FontWeight="SemiBold" Foreground="#666" Margin="0,0,0,10"/>
                                <StackPanel Margin="0,0,0,8">
                                    <TextBlock Text="Phone" FontSize="11" Foreground="#999" Margin="0,0,0,3"/>
                                    <TextBlock Name="HistoryPhone" FontSize="12" Foreground="#333"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,0,8">
                                    <TextBlock Text="Email" FontSize="11" Foreground="#999" Margin="0,0,0,3"/>
                                    <TextBlock Name="HistoryEmail" FontSize="12" Foreground="#333"/>
                                </StackPanel>
                                <StackPanel Margin="0,0,0,8">
                                    <TextBlock Text="Address" FontSize="11" Foreground="#999" Margin="0,0,0,3"/>
                                    <TextBlock Name="HistoryAddress" FontSize="12" Foreground="#333" TextWrapping="Wrap"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Repair History Section -->
                            <StackPanel Name="RepairHistoryPanel" Visibility="Collapsed">
                                <TextBlock Text="Repair History" FontSize="13" FontWeight="SemiBold" Foreground="#666" Margin="0,0,0,15"/>
                                <ItemsControl Name="RepairHistoryItems">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <Border Background="#F9F9F9" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="5" Padding="12" Margin="0,0,0,10">
                                                <Grid>
                                                    <Grid.RowDefinitions>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                        <RowDefinition Height="Auto"/>
                                                    </Grid.RowDefinitions>
                                                    
                                                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Stretch">
                                                        <TextBlock Text="{Binding DeviceModel}" FontSize="13" FontWeight="SemiBold" Foreground="#333"/>
                                                        <Border Background="#E8F5E9" Padding="6,2">
                                                            <TextBlock Text="{Binding Status}" FontSize="11" FontWeight="SemiBold" Foreground="#4CAF50"/>
                                                        </Border>
                                                    </StackPanel>
                                                    
                                                    <TextBlock Grid.Row="1" Text="{Binding Diagnosis}" FontSize="12" Foreground="#666" Margin="0,6,0,0" TextWrapping="Wrap"/>
                                                    
                                                    <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Stretch" Margin="0,8,0,0">
                                                        <TextBlock Text="{Binding CompletedAt}" FontSize="11" Foreground="#999"/>
                                                        <TextBlock Text="{Binding TotalCost}" FontSize="12" FontWeight="SemiBold" Foreground="#2196F3"/>
                                                    </StackPanel>
                                                </Grid>
                                            </Border>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </DockPanel>
    </Grid>
</Page>
